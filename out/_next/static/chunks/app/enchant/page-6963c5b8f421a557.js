(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[632],{3228:()=>{},6541:(e,a,l)=>{"use strict";l.d(a,{default:()=>j});var s=l(5155),t=l(2115),n=l(2039);l(9193),l(3228);var r=l(5110),i=l(2224),c=l(6451),x=l(9779),d=l(4540),o=l(5695),m=l(5424);let f=function(){let{affixLock:e}=(0,t.useContext)(x.A);return(0,s.jsxs)("div",{className:"flex flex-col max-w-[250px] p-1",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"此區塊可以操作指定遺器，模擬使用變量骰子後可能會出現的強化組合。下面為各功能簡單敘述:"})}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-white font-bold",children:"再洗一次"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"模擬使用變量骰子後所得到的結果"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-white font-bold",children:"套用新強化"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"將對照的遺器資訊替換成目前重洗後的模樣"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-white font-bold",children:"還原"})}),(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-stone-400",children:"將重洗次數以及遺器配置重設為一開始的配置。"})})]}),(0,s.jsxs)("div",{className:"mt-2 flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("span",{className:"text-white font-bold",children:"注意事項"})}),(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("span",{className:"!text-yellow-500",children:"重洗後的相關數據均存在誤差的可能，實際請以遊戲顯示的數值為主。"})}),e?(0,s.jsx)("div",{className:"mt-2 flex flex-col",children:(0,s.jsx)("span",{children:"此外如果該模擬資料有啟用鎖定詞條功能，則模擬過程中一併套用"})}):null]})]})},u=t.memo(()=>{let[e,a]=(0,t.useState)(),{relic:c,standDetails:u,Rscore:j,Rrank:w,mode:v,affixLock:N}=e||{},b=(0,t.useRef)(null),[D,g]=(0,t.useState)(!0),[k,y]=(0,t.useState)({oldData:null,newData:null}),[S,I]=(0,t.useState)(void 0),[A,F]=(0,t.useState)(0),[C,E]=(0,t.useState)(0),L=[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}],M=(0,d.d4)(e=>e.enchant.enchantData),_=(0,o.useRouter)(),[R,B]=(0,t.useState)();function O(){let e=[];L.forEach(a=>{e.push({label:a.rank,value:0,color:a.color,tag:a.rank})}),I(e)}function H(){switch(v){case"Importer":var e,a;let s,t,r,i,x;s=new Worker(l.tu(new URL(l.p+l.u(301),l.b))),t=n.A.find(e=>e.fieldName===c.main_affix.type),r=[],null===k.oldData?c.sub_affix.forEach((e,a)=>{let l=n.A.find(a=>a.fieldName===e.type),s=l.percent?Number((100*e.value).toFixed(1)):Number(e.value.toFixed(0)),t=u.find(e=>e.name===l.name),i={index:a,subaffix:l.name,data:s,count:e.count-1,stand:t?t.value:0,locked:!1};r.push(i)}):(r=k.oldData.returnData).forEach(e=>{let a=u.find(a=>a.name===e.subaffix);e.stand=a?a.value:0,e.locked=!1}),N&&(r.reduce((e,a)=>a.stand<e.stand?a:e).locked=!0),i=r.some(e=>"速度"===e.subaffix)?.5*(null!=(a=null==(e=u.find(e=>"速度"===e.name))?void 0:e.value)?a:0):0,r.forEach(e=>{"速度"!==e.subaffix&&0!==e.count&&(i+=.2)}),x={MainData:t.name,SubData:r,partsIndex:c.type,standard:u,deviation:0},s.postMessage(x),s.onmessage=function(e){y({oldData:{relicscore:null===k.oldData?j:k.oldData.relicscore,relicrank:null===k.oldData?w:k.oldData.relicrank,returnData:r},newData:e.data}),F(e=>e+=1),null!==k.oldData?parseInt(e.data.relicscore)>parseInt(k.oldData.relicscore)&&E(e=>e+=1):parseInt(e.data.relicscore)>parseInt(j)&&E(e=>e+=1)};break;case"Simulator":let d,o,m,f;d=new Worker(l.tu(new URL(l.p+l.u(682),l.b))),o=n.A.find(e=>e.name===c.main_affix),m=[],m=null===k.oldData?JSON.parse(JSON.stringify(c.subaffix)):k.oldData.returnData,f={MainData:o.name,SubData:m,partsIndex:c.type,standard:u,deviation:.5},d.postMessage(f),d.onmessage=function(e){y({oldData:{relicscore:null===k.oldData?j:k.oldData.relicscore,relicrank:null===k.oldData?w:k.oldData.relicrank,returnData:m},newData:e.data}),F(e=>e+=1),null!==k.oldData?parseInt(e.data.relicscore)>parseInt(k.oldData.relicscore)&&E(e=>e+=1):parseInt(e.data.relicscore)>parseInt(j)&&E(e=>e+=1)}}}(0,t.useEffect)(()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"smooth"})}),O(),H()},[e]),(0,t.useEffect)(()=>{M?a(M):(alert("沒有任何模擬數據，即將導回至主頁"),_.push("./")),null===b.current&&(b.current,k.oldData),function(){if(k.newData){if(void 0===S){let e=[],a={label:k.newData.relicrank.rank,value:1,color:L.find(e=>e.tag===k.newData.relicrank.rank).color,tag:k.newData.relicrank.rank};e.push(a),I(e);return}if(null==S.find(e=>e.label===k.newData.relicrank.rank)){let e={label:k.newData.relicrank.rank,value:1,color:L.find(e=>e.tag===k.newData.relicrank.rank).color,tag:k.newData.relicrank.rank};I(a=>[...null!=a?a:[],e])}else I(e=>(null!=e?e:[]).map(e=>e.tag===k.newData.relicrank.rank?{...e,value:e.value+1}:e))}}(),function(){if(null!==k.oldData&&null!==k.newData){if(1===A)B({min:Math.min(parseInt(k.oldData.relicscore),parseInt(k.newData.relicscore)),max:Math.max(parseInt(k.oldData.relicscore),parseInt(k.newData.relicscore))});else if(A>1){let e=k.newData.relicscore,a=JSON.parse(JSON.stringify(R));e>a.max?a.max=e:e<a.min&&(a.min=e),B(a)}}}()},[k]);let J=void 0!==k.newData&&void 0!==k.oldData?(0,s.jsxs)("div",{className:"flex flex-row flex-wrap  max-[600px]:!flex-col",children:[(0,s.jsx)(h,{standDetails:u,data:k.oldData,title:"重洗前",affixLock:N}),(0,s.jsxs)("div",{className:"flex my-auto w-[30px] moveAnimate moveAnimate2 max-[600px]:w-full h-[30px] ".concat(null===k.newData?"hidden":""),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"max-[600px]:hidden mx-auto",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#FFFFFF",children:(0,s.jsx)("path",{d:"m560-240-56-58 142-142H160v-80h486L504-662l56-58 240 240-240 240Z"})}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"min-[600px]:hidden mx-auto",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#e8eaed",children:(0,s.jsx)("path",{d:"M440-800v487L216-537l-56 57 320 320 320-320-56-57-224 224v-487h-80Z"})})]}),(0,s.jsx)(h,{standDetails:u,data:k.newData,title:"重洗後",affixLock:N})]}):null;return(0,s.jsxs)(x.A.Provider,{value:{relic:c,Rrank:w,Rscore:j,standDetails:u,isChangeAble:D,partArr:["Head 頭部","Hand 手部","Body 軀幹","Feet 腳部","Ball 位面球","Rope 連結繩"],PieNums:S,successCount:C,count:A,MinMaxScore:R,affixLock:N},children:[(0,s.jsxs)("div",{className:"flex flex-col w-4/5 mx-auto max-[600px]:w-[90%]",children:[(0,s.jsxs)("div",{className:"w-full border-gray-600 my-4 justify-center flex flex-row flex-wrap max-[900px]:flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row flex-wrap w-1/2 max-[900px]:w-full justify-evenly max-[900px]:mb-2",children:[(0,s.jsx)("div",{className:"w-[45%] h-fit flex flex-row max-[900px]:w-fit bg-black/50 p-2 rounded-md",children:"Importer"===v?(0,s.jsx)(i.G,{}):(0,s.jsx)(i.v,{})}),(0,s.jsx)("div",{className:"w-[45%] h-fit max-[900px]:w-fit bg-black/50 p-2 rounded-md ml-1 max-[900px]:ml-0 max-[900px]:my-2",children:(0,s.jsx)(r.V,{})})]}),(0,s.jsxs)("div",{className:"w-1/2 bg-black/50 h-fit p-2 rounded-md max-[900px]:w-full flex flex-col max-[900px]:items-center",children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsxs)("div",{className:"items-center flex flex-row",children:[(0,s.jsx)("span",{className:"text-red-600 text-lg font-bold",children:"模擬強化"}),(0,s.jsx)("div",{className:"hintIcon ml-2 overflow-visible","data-tooltip-id":"EnchantHint",children:(0,s.jsx)("span",{className:"text-white",children:"?"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>H(),children:"再洗一次"}),(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>void(null!==k.newData&&(y({oldData:k.newData,newData:null}),E(0))),children:"套用新強化"}),(0,s.jsx)("button",{className:"processBtn ml-2",onClick:()=>void(F(0),E(0),y({oldData:b.current,newData:null}),O()),children:"還原"})]})]}),(0,s.jsx)("div",{className:"my-2",children:(0,s.jsxs)("span",{children:["目前重洗次數:",(0,s.jsx)("span",{className:"text-white ml-1",children:A})]})}),void 0!==R?(0,s.jsx)("div",{children:J}):null,(0,s.jsx)("div",{children:(0,s.jsx)(p,{})})]})]}),(0,s.jsx)("div",{className:"bg-black/50 h-fit p-2 rounded-md w-fit"})]}),(0,s.jsx)(m.m_,{id:"EnchantHint",place:"right-start",render:()=>(0,s.jsx)(f,{})})]})}),h=t.memo(e=>{let{standDetails:a,data:l,title:t,affixLock:r}=e,i=[];if(!l||!a)return null;{let e="",c=1/0;return r&&l.returnData.forEach((l,s)=>{n.A.find(e=>e.name===l.subaffix).percent&&!l.data.toString().includes("%")?l.data:l.data.toString();let t=a.find(e=>e.name===l.subaffix),r=t?t.value:0;r<c&&(c=r,e=l.subaffix)}),l.returnData.map((l,t)=>{let r,c="",x=n.A.find(e=>e.name===l.subaffix),d=void 0!==a.find(e=>e.name===l.subaffix);r=x.percent&&!l.data.toString().includes("%")?l.data+"%":l.data;var o="https://raw.githubusercontent.com/Mar-7th/StarRailRes/master/icon/property/".concat(x.icon,".png");switch(l.count){case 0:c="rgb(122, 122, 122)";break;case 1:c="rgb(67, 143, 67)";break;case 2:c="rgb(23, 93, 232)";break;case 3:c="rgb(67, 17, 184)";break;case 4:c="rgb(219, 171, 15)";break;case 5:c="#FF55FF"}i.push((0,s.jsxs)("div",{className:"flex flex-row ".concat(e===l.subaffix?"strikeLine":""),children:[(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsx)("span",{className:"mr-0.5 text-white w-[20px] h-[20px] rounded-[20px]   flex justify-center items-center",style:{backgroundColor:c},children:l.count})}),(0,s.jsxs)("div",{className:"w-[120px] flex flex-row",children:[(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsx)("img",{src:o,alt:"555",width:24,height:24})}),(0,s.jsx)("span",{className:"".concat(e===l.subaffix?"text-stone-400":d?"text-yellow-500 font-bold":"text-white"," text-left flex"),children:l.subaffix})]}),(0,s.jsxs)("span",{className:"flex w-[70px]",children:[":",(0,s.jsx)("span",{className:"ml-2  ".concat(e===l.subaffix?"text-stone-400":"text-white"),children:r})]})]},"Subaffix_"+l.subaffix))}),(0,s.jsxs)("div",{className:"flex flex-col mx-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-amber-700 font-bold text-lg",children:t}),(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)("span",{children:"遺器評級:"}),(0,s.jsxs)("span",{className:"pl-2",style:{color:l.relicrank.color},children:[l.relicrank.rank," ",l.relicscore,"/100"]})]})]}),(0,s.jsx)("div",{children:i})]})}}),p=t.memo(()=>{let{PieNums:e,successCount:a,count:l,MinMaxScore:n}=(0,t.useContext)(x.A);return void 0!==e?(0,s.jsxs)("div",{className:"w-full flex flex-row flex-wrap",children:[(0,s.jsx)("div",{className:"min-w-[300px]",children:(0,s.jsx)(c.r,{series:[{innerRadius:20,arcLabelMinAngle:35,arcLabel:e=>"".concat(e.value,"次"),data:e}],height:200*(0!==l),margin:{top:10,right:0,bottom:0,left:0},hideLegend:!0})}),(0,s.jsx)("div",{className:"flex-col w-2/5 max-[500px]:w-full mt-2 ".concat(void 0===e.find(e=>0!==e.value)?"hidden":""),children:(0,s.jsxs)("div",{className:"flex-col justify-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("span",{className:"text-stone-400",children:"翻盤次數"})}),(0,s.jsx)("div",{className:"flex justify-start text-center ml-2",children:(0,s.jsxs)("span",{className:"text-white",children:[a,"次"]})})]}),n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-row items-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("span",{className:"text-stone-400",children:"最高分數"})}),(0,s.jsx)("div",{className:"flex justify-start text-center ml-2",children:(0,s.jsx)("span",{className:"text-white",children:n.max})})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center max-[600px]:w-3/5 max-[600px]:mx-auto",children:[(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("span",{className:"text-stone-400",children:"最低分數"})}),(0,s.jsx)("div",{className:"flex justify-start text-center ml-2",children:(0,s.jsx)("span",{className:"text-white",children:n.min})})]})]}):null]})})]}):null}),j=u},7578:(e,a,l)=>{Promise.resolve().then(l.bind(l,6541))}},e=>{var a=a=>e(e.s=a);e.O(0,[8,141,935,388,994,329,441,684,358],()=>a(7578)),_N_E=e.O()}]);