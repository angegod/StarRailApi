"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[661],{3661:()=>{let e=[{type:"main",data:[{name:"HPDelta",data:705,percent:!1},{name:"HPAddedRatio",data:43.2,percent:!0},{name:"AttackDelta",data:352.8,percent:!1},{name:"AttackAddedRatio",data:43.2,percent:!0},{name:"DefenceAddedRatio",data:54,percent:!0},{name:"CriticalChanceBase",data:32.4,percent:!0},{name:"CriticalDamageBase",data:64.8,percent:!0},{name:"BreakDamageAddedRatioBase",data:64.8,percent:!0},{name:"SpeedDelta",data:25,percent:!1},{name:"StatusProbabilityBase",data:43.2,percent:!0},{name:"IceAddedRatio",data:38.8,percent:!0},{name:"ImaginaryAddedRatio",data:38.8,percent:!0},{name:"PhysicalAddedRatio",data:38.8,percent:!0},{name:"FireAddedRatio",data:38.8,percent:!0},{name:"WindAddedRatio",data:38.8,percent:!0},{name:"ThunderAddedRatio",data:38.8,percent:!0},{name:"QuantumAddedRatio",data:38.8,percent:!0},{name:"SPRatioBase",data:19.4,percent:!0},{name:"HealRatioBase",data:34.5,percent:!0}]},{type:"sub",data:[{name:"HPDelta",data:42.4,percent:!1},{name:"HPAddedRatio",data:4.32,percent:!0},{name:"AttackDelta",data:21.2,percent:!1},{name:"AttackAddedRatio",data:4.32,percent:!0},{name:"DefenceDelta",data:21.2,percent:!1},{name:"DefenceAddedRatio",data:5.4,percent:!0},{name:"CriticalChanceBase",data:3.24,percent:!0},{name:"CriticalDamageBase",data:6.48,percent:!0},{name:"BreakDamageAddedRatioBase",data:6.48,percent:!0},{name:"SpeedDelta",data:2.6,percent:!1},{name:"StatusProbabilityBase",data:4.32,percent:!0},{name:"StatusResistanceBase",data:4.32,percent:!0}]}],a={1:{main:["hp"],sub:["hp","atk","def","spd","crit_rate","crit_dmg","effect_res","effect_hit","break_dmg"]},2:{main:["atk"],sub:["hp","atk","def","spd","crit_rate","crit_dmg","effect_res","effect_hit","break_dmg"]},3:{main:["atk","hp","def","crit_rate","crit_dmg","heal_rate","effect_hit"],sub:["hp","atk","def","spd","crit_rate","crit_dmg","effect_res","effect_hit","break_dmg"]},4:{main:["atk","hp","def","spd"],sub:["hp","atk","def","spd","crit_rate","crit_dmg","effect_res","effect_hit","break_dmg"]},5:{main:["atk","hp","def","physical_dmg","fire_dmg","ice_dmg","lightning_dmg","wind_dmg","quantum_dmg","imaginary_dmg"],sub:["hp","atk","def","spd","crit_rate","crit_dmg","effect_res","effect_hit","break_dmg"]},6:{main:["atk","hp","def","break_dmg","sp_rate"],sub:["hp","atk","def","spd","crit_rate","crit_dmg","effect_res","effect_hit","break_dmg"]}},t=[{fieldName:"HPDelta",icon:"IconMaxHP",type:"hp",name:"生命值",percent:!1,range:[34,38,42]},{fieldName:"HPAddedRatio",icon:"IconMaxHP",type:"hp",name:"生命值%數",percent:!0,range:[3.45,3.89,4.32]},{fieldName:"AttackDelta",icon:"IconAttack",type:"atk",name:"攻擊力",percent:!1,range:[17,19,21]},{fieldName:"AttackAddedRatio",icon:"IconAttack",type:"atk",name:"攻擊力%數",percent:!0,range:[3.45,3.89,4.32]},{fieldName:"DefenceDelta",icon:"IconDefence",type:"def",name:"防禦力",percent:!1,range:[17,19,21]},{fieldName:"DefenceAddedRatio",icon:"IconDefence",type:"def",name:"防禦力%數",percent:!0,range:[4.32,4.86,5.4]},{fieldName:"CriticalChanceBase",icon:"IconCriticalChance",type:"crit_rate",name:"暴擊率",percent:!0,range:[2.6,2.9,3.2]},{fieldName:"CriticalDamageBase",icon:"IconCriticalDamage",type:"crit_dmg",name:"暴擊傷害",percent:!0,range:[5.2,5.8,6.48]},{fieldName:"SpeedDelta",icon:"IconSpeed",type:"spd",name:"速度",percent:!1,range:[2,2.3,2.6]},{fieldName:"BreakDamageAddedRatioBase",icon:"IconBreakUp",type:"break_dmg",name:"擊破特攻",percent:!0,range:[5.2,5.8,6.5]},{fieldName:"SPRatioBase",icon:"IconEnergyRecovery",type:"sp_rate",name:"能量恢復效率",percent:!0},{fieldName:"HealRatioBase",icon:"IconHealRatio",type:"heal_rate",name:"治療量加成",percent:!0},{fieldName:"StatusProbabilityBase",icon:"IconStatusProbability",type:"effect_hit",name:"效果命中",percent:!0,range:[3.45,3.89,4.32]},{fieldName:"StatusResistanceBase",icon:"IconStatusResistance",type:"effect_res",name:"效果抗性",percent:!0,range:[3.45,3.89,4.32]},{fieldName:"PhysicalAddedRatio",icon:"IconPhysicalAddedRatio",type:"physical_dmg",name:"物理屬性傷害提高",percent:!0},{fieldName:"FireAddedRatio",icon:"IconFireAddedRatio",type:"fire_dmg",name:"火屬性傷害提高",percent:!0},{fieldName:"IceAddedRatio",icon:"IconIceAddedRatio",type:"ice_dmg",name:"冰屬性傷害提高",percent:!0},{fieldName:"ThunderAddedRatio",icon:"IconThunderAddedRatio",type:"lightning_dmg",name:"雷屬性傷害提高",percent:!0},{fieldName:"WindAddedRatio",icon:"IconWindAddedRatio",type:"wind_dmg",name:"風屬性傷害提高",percent:!0},{fieldName:"QuantumAddedRatio",icon:"IconQuantumAddedRatio",type:"quantum_dmg",name:"量子屬性傷害提高",percent:!0},{fieldName:"ImaginaryAddedRatio",icon:"IconImaginaryAddedRatio",type:"imaginary_dmg",name:"虛數屬性傷害提高",percent:!0}];function n(e,t){let n=5,d=null,i=Object.entries(e).sort((e,a)=>a[1]-e[1]);if(1!==t&&2!==t){for(let[e,r]of i){let i=!a[t].sub.includes(e);if(a[t].main.includes(e)&&!d&&i&&0!==r){d=e,n+=3*r;break}}if(!d){for(let[e,r]of i)if(a[t].main.includes(e)){d=e,n+=3*r;break}}}let r=0;for(let[e,c]of i)e!==d&&r<4&&a[t].sub.includes(e)&&(n+=c,r++);return n}onmessage=function(a){var d,i,r,c,m;let o,p,f,l,s=a.data.SubData,g=parseInt(a.data.partsIndex),u=t.find(e=>e.name===a.data.MainData),h=void 0!==a.data.deviation?a.data.deviation:0,_=0,y=[];s.forEach(e=>{_+=Number(e.count),e.locked&&y.push(e.index)});let b=function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=[];return!function t(d,i){if(d.length===a){i===e&&n.push([...d]);return}for(let a=0;a<=e-i;a++)d.push(a),t(d,i+a),d.pop()}([],0),n.filter(e=>t.every(a=>0===e[a]))}(_,s.length,y),k=(d=a.data.standard,o={hp:0,atk:0,def:0,spd:0,crit_rate:0,crit_dmg:0,break_dmg:0,heal_rate:0,sp_rate:0,effect_hit:0,effect_res:0,physical_dmg:0,fire_dmg:0,ice_dmg:0,lightning_dmg:0,wind_dmg:0,quantum_dmg:0,imaginary_dmg:0},d.forEach(e=>{o[t.find(a=>a.name===e.name).type]=e.value}),o),A=[];s.forEach(e=>{let a=t.find(a=>a.name===e.subaffix);A.push({type:a.type,fieldName:a.fieldName,num:Number(k[a.type])})});let N=k[u.type],R=[],D=(i=g,r=k,c=s,m=N,p=0,f=[],1!==i&&2!==i&&(p+=3*m),c.forEach(a=>{let n=Number(a.data.toFixed(2)),d=t.find(e=>e.name===a.subaffix),i=Number(parseFloat((n/e.find(e=>"sub"===e.type).data.find(e=>e.name===d.fieldName).data).toFixed(2))),c=r[d.type]*i;f.push({type:d.fieldName,affixmutl:c})}),f.forEach(e=>{"AttackDelta"!==e.type&&"DefenceDelta"!==e.type&&"HPDelta"!==e.type&&(p+=e.affixmutl)}),l=0,Number((100*Number((p/n(r,i)).toFixed(4))).toFixed(1))),I=n(k,g);console.log(I),new Promise(async(a,n)=>{b.forEach((a,n)=>{(function(e){let a=[],t=[0,1,2];return!function n(d,i){if(d===e.length)return void a.push([...i.map(e=>[...e])]);let r=e[d],c=[];for(let e of(!function e(a){if(a.length===r)return void c.push([...a]);for(let n of t)a.push(n),e(a),a.pop()}([]),c))i.push(e),n(d+1,i),i.pop()}(0,[]),a})(a).forEach(a=>{let n=0;1!==g&&2!==g&&(n=3*N);let d=0,i=[];a.forEach((a,n)=>{let r=A[n],c=t.find(e=>e.fieldName===r.fieldName).range;d=0===s[n].count?s[n].data:c[1],a.forEach(e=>d+=c[e]);let m=e.find(e=>"sub"===e.type).data.find(e=>e.name===r.fieldName).data,o=parseFloat((d/m).toFixed(2)),p=k[r.type]*o;i.push({type:r.fieldName,affixmutl:p})}),i.forEach(e=>{"AttackDelta"!==e.type&&"DefenceDelta"!==e.type&&"HPDelta"!==e.type&&(n+=e.affixmutl)});let r=Number((n/I*100).toFixed(2));R.push(r)})}),a(D)}).then(e=>{let a,t=(JSON.parse(JSON.stringify(R)).filter(e=>e-h>Number(D)).length/R.length).toFixed(4),n=JSON.parse(JSON.stringify(R)),d=[];[{rank:"S+",stand:85,color:"rgb(239, 68, 68)",tag:"S+"},{rank:"S",stand:70,color:"rgb(239, 68, 68)",tag:"S"},{rank:"A",stand:50,color:"rgb(234, 179, 8)",tag:"A"},{rank:"B",stand:35,color:"rgb(234, 88 , 12)",tag:"B"},{rank:"C",stand:15,color:"rgb(163, 230, 53)",tag:"C"},{rank:"D",stand:0,color:"rgb(22,163,74)",tag:"D"}].forEach((e,t)=>{let i=n.filter(a=>a>=e.stand);n=n.filter(a=>a<e.stand),d.push({label:e.tag,value:Number((i.length/R.length*100).toFixed(2)),color:e.color,tag:e.rank}),e.stand<=D&&void 0===a&&(a=e)}),this.postMessage({expRate:t||0,relicscore:e,relicrank:a,returnData:d})})}}}]);